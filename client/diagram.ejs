<script type="text/javascript" src="/node_modules/chart.js/dist/Chart.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script src="/assets/main.js"></script>
<script>
	//  https://coronavirusapi-france.now.sh/AllDataByDate?date=2020-04-19
	/**
	 * Tout le js que je mets en dessous de ce commentaire ça sera dans le main.js et dans l'event click
	 * Je mets une date en dur mais il faudra remplacer par la date récupérer dans l input comme on a dans le main
	 * Tu pourras prendre tout ce qu'il y a dans la function et supprimer la function car j en ai juste besoin pour
	 * le async mais sur l event click il y a deja un async
	 */

	async function callApi() {
		// Date d exemple
		const date = '2020-04-19'
		try {
			// call api
			const callApi = await axios.get(`https://coronavirusapi-france.now.sh/AllDataByDate?date=${date}`)
			// result api
			const resultApi = await callApi.data.allFranceDataByDate

			// check all data in array
			resultApi.forEach(async (item, i) => {
				// call db
				let callDB = await axios.get(`/update/${item.date}/${item.nom}`)
				let resultDB = await callDB.data

				// if result is empty then push in db
				if (Object.keys(resultDB).length === 0) {
					// Make axios post (requete dans server.js method post)
					console.log(resultDB)
				}
			});
		} catch(err) {
			console.error(err)
		}

	}

	callApi()


</script>